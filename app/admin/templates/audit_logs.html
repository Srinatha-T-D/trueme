<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Audit Logs ‚Ä¢ TRUEME Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-10">

<h1 class="text-2xl font-bold mb-6 flex items-center gap-2">
  üîê Admin Audit Logs
</h1>

<div class="bg-white p-6 rounded shadow overflow-x-auto">

<table class="w-full text-sm border">
  <thead class="bg-gray-200">
    <tr>
      <th class="p-2">ID</th>
      <th class="p-2">Admin ID</th>
      <th class="p-2">Action</th>
      <th class="p-2">Entity</th>
      <th class="p-2">Entity ID</th>
      <th class="p-2">Time</th>
    </tr>
  </thead>
  <tbody id="rows"></tbody>
</table>

</div>

<a href="/admin/dashboard"
   class="inline-block mt-6 text-blue-600 hover:underline">
  ‚Üê Back to Dashboard
</a>

<script>
async function fetchJSON(url) {
  const res = await fetch(url, { credentials: "same-origin" });
  if (res.status === 401) {
    window.location.href = "/admin/login";
    return [];
  }
  return res.json();
}

async function load() {
  const data = await fetchJSON("/admin/audit/data");
  const tbody = document.getElementById("rows");

  if (!data || data.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="6" class="p-4 text-center text-gray-500">
          No audit logs found
        </td>
      </tr>`;
    return;
  }

  tbody.innerHTML = data.map(l => `
    <tr class="border-t">
      <td class="p-2">${l.id}</td>
      <td class="p-2">${l.admin_id}</td>
      <td class="p-2 font-medium">${l.action}</td>
      <td class="p-2">${l.entity}</td>
      <td class="p-2">${l.entity_id ?? "-"}</td>
      <td class="p-2 text-xs text-gray-600">${l.created_at}</td>
    </tr>
  `).join("");
}

load();
</script>

</body>
</html>
